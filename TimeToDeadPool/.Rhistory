#theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
#      legend.position = c(0.8,0.7))
theme(text = element_text(size=20), legend.text=element_text(size=18))
ggplot(data = dfReleaseToStabilizeMelt %>% filter(Elevation %in% c("1025","1050","1090"))) +
geom_area(aes(x=Inflow/1e6, y=value/1e6, fill=variable)) +
facet_wrap( ~ Elevation) +
#Limit the x-axis to reasonable inflows
#xlim(7,10) +
#Reverse x-axis so go from High to Low
scale_x_reverse(limits = c(10,7)) +
scale_y_continuous(breaks = seq(0,10,by=2), sec.axis = sec_axis(~. +0, name = "", breaks = dfReleaseLabels$Release/1e6, labels = dfReleaseLabels$Label)) +
scale_fill_manual(values = c("Red","Pink", pBlues[4]), labels = c("Mandatory conservation\ntarget", "Additional conservation", "Release")) +
theme_bw() +
labs(x="Inflow (MAF per year)", y="Release\n(MAF per year)", fill="") +
#theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
#      legend.position = c(0.8,0.7))
theme(text = element_text(size=20), legend.text=element_text(size=18))
ggplot(data = dfReleaseToStabilizeMelt %>% filter(Elevation %in% c("1025","1050","1090"))) +
geom_area(aes(x=Inflow/1e6, y=value/1e6, fill=variable)) +
facet_wrap( ~ Elevation) +
#Limit the x-axis to reasonable inflows
#xlim(7,10) +
#Reverse x-axis so go from High to Low
scale_x_reverse(limits = c(10,7)) +
scale_y_continuous(breaks = seq(0,10,by=2), sec.axis = sec_axis(~. +0, name = "", breaks = dfReleaseLabels$Release/1e6, labels = dfReleaseLabels$Label)) +
scale_fill_manual(values = c("Red","Pink", pBlues[4]), labels = c("Mandatory conservation\ntarget", "Additional conservation", "Release")) +
#Add line annotations
#Horizonal line for Havasu Parker
geom_hline(yintercept = dfReleaseLabels$Release[3]/1e6, linetype = "dashed", size = 1.25) +
theme_bw() +
labs(x="Inflow (MAF per year)", y="Release\n(MAF per year)", fill="") +
#theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
#      legend.position = c(0.8,0.7))
theme(text = element_text(size=20), legend.text=element_text(size=18))
ggplot(data = dfReleaseToStabilizeMelt %>% filter(Elevation %in% c("1025","1050","1090"))) +
geom_area(aes(x=Inflow/1e6, y=value/1e6, fill=variable)) +
facet_wrap( ~ Elevation) +
#Limit the x-axis to reasonable inflows
#xlim(7,10) +
#Reverse x-axis so go from High to Low
scale_x_reverse(limits = c(10,7)) +
scale_y_continuous(breaks = seq(0,10,by=2), sec.axis = sec_axis(~. +0, name = "", breaks = dfReleaseLabels$Release/1e6, labels = dfReleaseLabels$Label)) +
scale_fill_manual(values = c("Red","Pink", pBlues[4]), labels = c("Mandatory conservation\ntarget", "Additional conservation", "Release")) +
#Add line annotations
#Horizonal line for Havasu Parker
geom_hline(yintercept = dfReleaseLabels$Release[3]/1e6, linetype = "dashed", size = 1.25) +
#Sloped line for release to stabalize level
geom_abline(slope = -1, intercept =vLowerBasinDeliveryTarget/1e6, linetype = "dasheddot", size = 2 ) +
theme_bw() +
labs(x="Inflow (MAF per year)", y="Release\n(MAF per year)", fill="") +
#theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
#      legend.position = c(0.8,0.7))
theme(text = element_text(size=20), legend.text=element_text(size=18))
ggplot(data = dfReleaseToStabilizeMelt %>% filter(Elevation %in% c("1025","1050","1090"))) +
geom_area(aes(x=Inflow/1e6, y=value/1e6, fill=variable)) +
facet_wrap( ~ Elevation) +
#Limit the x-axis to reasonable inflows
#xlim(7,10) +
#Reverse x-axis so go from High to Low
scale_x_reverse(limits = c(10,7)) +
scale_y_continuous(breaks = seq(0,10,by=2), sec.axis = sec_axis(~. +0, name = "", breaks = dfReleaseLabels$Release/1e6, labels = dfReleaseLabels$Label)) +
scale_fill_manual(values = c("Red","Pink", pBlues[4]), labels = c("Mandatory conservation\ntarget", "Additional conservation", "Release")) +
#Add line annotations
#Horizonal line for Havasu Parker
geom_hline(yintercept = dfReleaseLabels$Release[3]/1e6, linetype = "dashed", size = 1.25) +
#Sloped line for release to stabalize level
geom_abline(slope = -1, intercept =vLowerBasinDeliveryTarget/1e6, linetype = "longdash", size = 2 ) +
theme_bw() +
labs(x="Inflow (MAF per year)", y="Release\n(MAF per year)", fill="") +
#theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
#      legend.position = c(0.8,0.7))
theme(text = element_text(size=20), legend.text=element_text(size=18))
ggplot(data = dfReleaseToStabilizeMelt %>% filter(Elevation %in% c("1025","1050","1090"))) +
geom_area(aes(x=Inflow/1e6, y=value/1e6, fill=variable)) +
facet_wrap( ~ Elevation) +
#Limit the x-axis to reasonable inflows
#xlim(7,10) +
#Reverse x-axis so go from High to Low
scale_x_reverse(limits = c(10,7)) +
scale_y_continuous(breaks = seq(0,10,by=2), sec.axis = sec_axis(~. +0, name = "", breaks = dfReleaseLabels$Release/1e6, labels = dfReleaseLabels$Label)) +
scale_fill_manual(values = c("Red","Pink", pBlues[4]), labels = c("Mandatory conservation\ntarget", "Additional conservation", "Release")) +
#Add line annotations
#Horizonal line for Havasu Parker
geom_hline(yintercept = dfReleaseLabels$Release[3]/1e6, linetype = "dashed", size = 1.25) +
#Sloped line for release to stabalize level
geom_abline(slope = -1, intercept =-0.4, linetype = "longdash", size = 2 ) +
theme_bw() +
labs(x="Inflow (MAF per year)", y="Release\n(MAF per year)", fill="") +
#theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
#      legend.position = c(0.8,0.7))
theme(text = element_text(size=20), legend.text=element_text(size=18))
dfReleaseToStabilizeLine <- dfReleaseToStabilize %>% filter(Inflow = min(dfReleaseToStabilize$Inflow))
dfReleaseToStabilizeLine <- dfReleaseToStabilize %>% filter(Inflow == min(dfReleaseToStabilize$Inflow))
View(dfReleaseToStabilizeLine)
ggplot(data = dfReleaseToStabilizeMelt %>% filter(Elevation %in% c("1025","1050","1090"))) +
#The main types
geom_area(aes(x=Inflow/1e6, y=value/1e6, fill=variable)) +
#Overplot a line for the line of releases to stabilize inflow
geom_line(data=dfReleaseToStablize, aes(x=Inflow/1e6, y = ReleaseToStabilize/1e6), linetype = "Longdash", size = 2) +
facet_wrap( ~ Elevation) +
#Limit the x-axis to reasonable inflows
#xlim(7,10) +
#Reverse x-axis so go from High to Low
scale_x_reverse(limits = c(10,7)) +
scale_y_continuous(breaks = seq(0,10,by=2), sec.axis = sec_axis(~. +0, name = "", breaks = dfReleaseLabels$Release/1e6, labels = dfReleaseLabels$Label)) +
scale_fill_manual(values = c("Red","Pink", pBlues[4]), labels = c("Mandatory conservation\ntarget", "Additional conservation", "Release")) +
#Add line annotations
#Horizonal line for Havasu Parker
geom_hline(yintercept = dfReleaseLabels$Release[3]/1e6, linetype = "dashed", size = 1.25) +
#Sloped line for release to stabalize level
#geom_abline(slope = -1, intercept =-0.4, linetype = "longdash", size = 2 ) +
theme_bw() +
labs(x="Inflow (MAF per year)", y="Release\n(MAF per year)", fill="") +
#theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
#      legend.position = c(0.8,0.7))
theme(text = element_text(size=20), legend.text=element_text(size=18))
ggplot(data = dfReleaseToStabilizeMelt %>% filter(Elevation %in% c("1025","1050","1090"))) +
#The main types
geom_area(aes(x=Inflow/1e6, y=value/1e6, fill=variable)) +
#Overplot a line for the line of releases to stabilize inflow
geom_line(data=dfReleaseToStabilize, aes(x=Inflow/1e6, y = ReleaseToStabilize/1e6), linetype = "Longdash", size = 2) +
facet_wrap( ~ Elevation) +
#Limit the x-axis to reasonable inflows
#xlim(7,10) +
#Reverse x-axis so go from High to Low
scale_x_reverse(limits = c(10,7)) +
scale_y_continuous(breaks = seq(0,10,by=2), sec.axis = sec_axis(~. +0, name = "", breaks = dfReleaseLabels$Release/1e6, labels = dfReleaseLabels$Label)) +
scale_fill_manual(values = c("Red","Pink", pBlues[4]), labels = c("Mandatory conservation\ntarget", "Additional conservation", "Release")) +
#Add line annotations
#Horizonal line for Havasu Parker
geom_hline(yintercept = dfReleaseLabels$Release[3]/1e6, linetype = "dashed", size = 1.25) +
#Sloped line for release to stabalize level
#geom_abline(slope = -1, intercept =-0.4, linetype = "longdash", size = 2 ) +
theme_bw() +
labs(x="Inflow (MAF per year)", y="Release\n(MAF per year)", fill="") +
#theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
#      legend.position = c(0.8,0.7))
theme(text = element_text(size=20), legend.text=element_text(size=18))
ggplot(data = dfReleaseToStabilizeMelt %>% filter(Elevation %in% c("1025","1050","1090"))) +
#The main types
geom_area(aes(x=Inflow/1e6, y=value/1e6, fill=variable)) +
#Overplot a line for the line of releases to stabilize inflow
geom_line(data=dfReleaseToStabilize, aes(x=Inflow/1e6, y = ReleaseToStabilize/1e6), linetype = "Longdash", size = 2) +
facet_wrap( ~ Elevation) +
#Limit the x-axis to reasonable inflows
#xlim(7,10) +
#Reverse x-axis so go from High to Low
scale_x_reverse(limits = c(10,7)) +
scale_y_continuous(breaks = seq(0,10,by=2), sec.axis = sec_axis(~. +0, name = "", breaks = dfReleaseLabels$Release/1e6, labels = dfReleaseLabels$Label)) +
scale_fill_manual(values = c("Red","Pink", pBlues[4]), labels = c("Mandatory conservation\ntarget", "Additional conservation", "Release")) +
#Add line annotations
#Horizonal line for Havasu Parker
geom_hline(yintercept = dfReleaseLabels$Release[3]/1e6, linetype = "dashed", size = 1.25, color = pBlue[9]) +
#Sloped line for release to stabalize level
#geom_abline(slope = -1, intercept =-0.4, linetype = "longdash", size = 2 ) +
theme_bw() +
labs(x="Inflow (MAF per year)", y="Release\n(MAF per year)", fill="") +
#theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
#      legend.position = c(0.8,0.7))
theme(text = element_text(size=20), legend.text=element_text(size=18))
ggplot(data = dfReleaseToStabilizeMelt %>% filter(Elevation %in% c("1025","1050","1090"))) +
#The main types
geom_area(aes(x=Inflow/1e6, y=value/1e6, fill=variable)) +
#Overplot a line for the line of releases to stabilize inflow
geom_line(data=dfReleaseToStabilize, aes(x=Inflow/1e6, y = ReleaseToStabilize/1e6), linetype = "Longdash", size = 2) +
facet_wrap( ~ Elevation) +
#Limit the x-axis to reasonable inflows
#xlim(7,10) +
#Reverse x-axis so go from High to Low
scale_x_reverse(limits = c(10,7)) +
scale_y_continuous(breaks = seq(0,10,by=2), sec.axis = sec_axis(~. +0, name = "", breaks = dfReleaseLabels$Release/1e6, labels = dfReleaseLabels$Label)) +
scale_fill_manual(values = c("Red","Pink", pBlues[4]), labels = c("Mandatory conservation\ntarget", "Additional conservation", "Release")) +
#Add line annotations
#Horizonal line for Havasu Parker
geom_hline(yintercept = dfReleaseLabels$Release[3]/1e6, linetype = "dashed", size = 1.25, color = pBlues[9]) +
#Sloped line for release to stabalize level
#geom_abline(slope = -1, intercept =-0.4, linetype = "longdash", size = 2 ) +
theme_bw() +
labs(x="Inflow (MAF per year)", y="Release\n(MAF per year)", fill="") +
#theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
#      legend.position = c(0.8,0.7))
theme(text = element_text(size=20), legend.text=element_text(size=18))
ggplot(data = dfReleaseToStabilizeMelt %>% filter(Elevation %in% c("1025","1050","1090"))) +
#The main types
geom_area(aes(x=Inflow/1e6, y=value/1e6, fill=variable)) +
#Overplot a line for the line of releases to stabilize inflow
#geom_line(data=dfReleaseToStabilize, aes(x=Inflow/1e6, y = ReleaseToStabilize/1e6), linetype = "Longdash", size = 2) +
facet_wrap( ~ Elevation) +
#Limit the x-axis to reasonable inflows
#xlim(7,10) +
#Reverse x-axis so go from High to Low
scale_x_reverse(limits = c(10,7)) +
scale_y_continuous(breaks = seq(0,10,by=2), sec.axis = sec_axis(~. +0, name = "", breaks = dfReleaseLabels$Release/1e6, labels = dfReleaseLabels$Label)) +
scale_fill_manual(values = c("Red","Pink", pBlues[4]), labels = c("Mandatory conservation\ntarget", "Additional conservation", "Release")) +
#Add line annotations
#Horizonal line for Havasu Parker
geom_hline(yintercept = dfReleaseLabels$Release[3]/1e6, linetype = "dashed", size = 1.25, color = pBlues[9]) +
#Sloped line for release to stabalize level
#geom_abline(slope = -1, intercept =-0.4, linetype = "longdash", size = 2 ) +
theme_bw() +
labs(x="Inflow (MAF per year)", y="Release\n(MAF per year)", fill="") +
#theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
#      legend.position = c(0.8,0.7))
theme(text = element_text(size=20), legend.text=element_text(size=18))
dfReleaseLabels <- data.frame(Release = c(vLowerBasinDeliveryTarget,vLowerBasinDeliveryTarget - max(dfReleaseToStabilize$MandatoryConservationTarget),600000),
Label = c("Target\nrelease","Max. mandatory\n conservation", "Havasu/Parker\nevap. + ET"))
ggplot(data = dfReleaseToStabilizeMelt %>% filter(Elevation %in% c("1025","1050","1090"))) +
#The main types
geom_area(aes(x=Inflow/1e6, y=value/1e6, fill=variable)) +
#Overplot a line for the line of releases to stabilize inflow
#geom_line(data=dfReleaseToStabilize, aes(x=Inflow/1e6, y = ReleaseToStabilize/1e6), linetype = "Longdash", size = 2) +
facet_wrap( ~ Elevation) +
#Limit the x-axis to reasonable inflows
#xlim(7,10) +
#Reverse x-axis so go from High to Low
scale_x_reverse(limits = c(10,7)) +
scale_y_continuous(breaks = seq(0,10,by=2), sec.axis = sec_axis(~. +0, name = "", breaks = dfReleaseLabels$Release/1e6, labels = dfReleaseLabels$Label)) +
scale_fill_manual(values = c("Red","Pink", pBlues[4]), labels = c("Mandatory conservation\ntarget", "Additional conservation", "Release")) +
#Add line annotations
#Horizonal line for Havasu Parker
geom_hline(yintercept = dfReleaseLabels$Release[3]/1e6, linetype = "dashed", size = 1.25, color = pBlues[9]) +
#Sloped line for release to stabalize level
#geom_abline(slope = -1, intercept =-0.4, linetype = "longdash", size = 2 ) +
theme_bw() +
labs(x="Inflow (MAF per year)", y="Release\n(MAF per year)", fill="") +
#theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
#      legend.position = c(0.8,0.7))
theme(text = element_text(size=20), legend.text=element_text(size=18))
ggplot(data = dfReleaseToStabilizeMelt %>% filter(Elevation %in% c("1025","1090"))) +
#The main types
geom_area(aes(x=Inflow/1e6, y=value/1e6, fill=variable)) +
#Overplot a line for the line of releases to stabilize inflow
#geom_line(data=dfReleaseToStabilize, aes(x=Inflow/1e6, y = ReleaseToStabilize/1e6), linetype = "Longdash", size = 2) +
facet_wrap( ~ Elevation) +
#Limit the x-axis to reasonable inflows
#xlim(7,10) +
#Reverse x-axis so go from High to Low
scale_x_reverse(limits = c(10,7)) +
scale_y_continuous(breaks = seq(0,10,by=2), sec.axis = sec_axis(~. +0, name = "", breaks = dfReleaseLabels$Release/1e6, labels = dfReleaseLabels$Label)) +
scale_fill_manual(values = c("Red","Pink", pBlues[4]), labels = c("Mandatory conservation\ntarget", "Additional conservation", "Release")) +
#Add line annotations
#Horizonal line for Havasu Parker
geom_hline(yintercept = dfReleaseLabels$Release[3]/1e6, linetype = "dashed", size = 1.25, color = pBlues[9]) +
#Sloped line for release to stabalize level
#geom_abline(slope = -1, intercept =-0.4, linetype = "longdash", size = 2 ) +
theme_bw() +
labs(x="Inflow (MAF per year)", y="Release\n(MAF per year)", fill="") +
#theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
#      legend.position = c(0.8,0.7))
theme(text = element_text(size=20), legend.text=element_text(size=18))
ggplot(data = dfReleaseToStabilizeMelt %>% filter(Elevation %in% c("1025","1090"))) +
#The main types
geom_area(aes(x=Inflow/1e6, y=value/1e6, fill=variable)) +
#Overplot a line for the line of releases to stabilize inflow
geom_line(data=dfReleaseToStabilize, aes(x=Inflow/1e6, y = ReleaseToStabilize/1e6), linetype = "longdash", size = 2) +
facet_wrap( ~ Elevation) +
#Limit the x-axis to reasonable inflows
#xlim(7,10) +
#Reverse x-axis so go from High to Low
scale_x_reverse(limits = c(10,7)) +
scale_y_continuous(breaks = seq(0,10,by=2), sec.axis = sec_axis(~. +0, name = "", breaks = dfReleaseLabels$Release/1e6, labels = dfReleaseLabels$Label)) +
scale_fill_manual(values = c("Red","Pink", pBlues[4]), labels = c("Mandatory conservation\ntarget", "Additional conservation", "Release")) +
#Add line annotations
#Horizonal line for Havasu Parker
geom_hline(yintercept = dfReleaseLabels$Release[3]/1e6, linetype = "dashed", size = 1.25, color = pBlues[9]) +
#Sloped line for release to stabalize level
#geom_abline(slope = -1, intercept =-0.4, linetype = "longdash", size = 2 ) +
theme_bw() +
labs(x="Inflow (MAF per year)", y="Release\n(MAF per year)", fill="") +
#theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
#      legend.position = c(0.8,0.7))
theme(text = element_text(size=20), legend.text=element_text(size=18))
ggplot(data = dfReleaseToStabilizeMelt %>% filter(Elevation %in% c("1025","1090"))) +
#The main types
geom_area(aes(x=Inflow/1e6, y=value/1e6, fill=variable)) +
#Overplot a line for the line of releases to stabilize inflow
geom_line(data=dfReleaseToStabilize %>% filter(Elevation %in% c("1025","1090")), aes(x=Inflow/1e6, y = ReleaseToStabilize/1e6), linetype = "longdash", size = 2) +
facet_wrap( ~ Elevation) +
#Limit the x-axis to reasonable inflows
#xlim(7,10) +
#Reverse x-axis so go from High to Low
scale_x_reverse(limits = c(10,7)) +
scale_y_continuous(breaks = seq(0,10,by=2), sec.axis = sec_axis(~. +0, name = "", breaks = dfReleaseLabels$Release/1e6, labels = dfReleaseLabels$Label)) +
scale_fill_manual(values = c("Red","Pink", pBlues[4]), labels = c("Mandatory conservation\ntarget", "Additional conservation", "Release")) +
#Add line annotations
#Horizonal line for Havasu Parker
geom_hline(yintercept = dfReleaseLabels$Release[3]/1e6, linetype = "dashed", size = 1.25, color = pBlues[9]) +
#Sloped line for release to stabalize level
#geom_abline(slope = -1, intercept =-0.4, linetype = "longdash", size = 2 ) +
theme_bw() +
labs(x="Inflow (MAF per year)", y="Release\n(MAF per year)", fill="") +
#theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
#      legend.position = c(0.8,0.7))
theme(text = element_text(size=20), legend.text=element_text(size=18))
ggplot(data = dfReleaseToStabilizeMelt %>% filter(Elevation %in% c("1025","1090"))) +
#The main types
geom_area(aes(x=Inflow/1e6, y=value/1e6, fill=variable)) +
#Overplot a line for the line of releases to stabilize inflow
geom_line(data=dfReleaseToStabilize %>% filter(Elevation %in% c("1025","1090")), aes(x=Inflow/1e6, y = ReleaseToStabilize/1e6), linetype = "longdash", size = 2) +
facet_wrap( ~ Elevation) +
#Limit the x-axis to reasonable inflows
#xlim(7,10) +
#Reverse x-axis so go from High to Low
scale_x_reverse(limits = c(10,7)) +
scale_y_continuous(limits = c(0,10), breaks = seq(0,10,by=2), sec.axis = sec_axis(~. +0, name = "", breaks = dfReleaseLabels$Release/1e6, labels = dfReleaseLabels$Label)) +
scale_fill_manual(values = c("Red","Pink", pBlues[4]), labels = c("Mandatory conservation\ntarget", "Additional conservation", "Release")) +
#Add line annotations
#Horizonal line for Havasu Parker
geom_hline(yintercept = dfReleaseLabels$Release[3]/1e6, linetype = "dashed", size = 1.25, color = pBlues[9]) +
#Sloped line for release to stabalize level
#geom_abline(slope = -1, intercept =-0.4, linetype = "longdash", size = 2 ) +
theme_bw() +
labs(x="Inflow (MAF per year)", y="Release\n(MAF per year)", fill="") +
#theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
#      legend.position = c(0.8,0.7))
theme(text = element_text(size=20), legend.text=element_text(size=18))
dfTraceLabels <- data.frame(Elevation=1090,Inflow = c(8.5,9,8.5), Label=c("Mandatory conservation", "Additional\nconservation", "Release"))
dfTraceLabels <- data.frame(Elevation=1090,Inflow = c(8.5,9,8.5), Release = c(9.6-0.3/2, 8.6, 5), Label=c("Mandatory conservation", "Additional\nconservation", "Release"))
#Calculate the additional conservation needed beyond DCP target
dfReleaseToStabilize$AdditionalConservation <- dfReleaseToStabilize$DeliveryTarget  - dfReleaseToStabilize$MandatoryConservationTarget - dfReleaseToStabilize$Release
dfReleaseToStabilize$AdditionalConservation <- ifelse(dfReleaseToStabilize$AdditionalConservation < 0, 0, dfReleaseToStabilize$AdditionalConservation)
#Melt the selected plot columns
dfReleaseToStabilizeMelt <- melt(dfReleaseToStabilize, id.vars = c("Elevation", "Volume", "Inflow"), measure.vars = c("MandatoryConservationTarget","AdditionalConservation","Release") )
#Create a data frame to right label the y-axis
dfReleaseLabels <- data.frame(Release = c(vLowerBasinDeliveryTarget,vLowerBasinDeliveryTarget - max(dfReleaseToStabilize$MandatoryConservationTarget),600000),
Label = c("Target\nrelease","Max. mandatory\n conservation", "Havasu/Parker\nevap. + ET"))
ggplot(data = dfReleaseToStabilizeMelt %>% filter(Elevation %in% c("1025","1090"))) +
#The main types
geom_area(aes(x=Inflow/1e6, y=value/1e6, fill=variable)) +
#Overplot a line for the line of releases to stabilize inflow
geom_line(data=dfReleaseToStabilize %>% filter(Elevation %in% c("1025","1090")), aes(x=Inflow/1e6, y = ReleaseToStabilize/1e6), linetype = "longdash", size = 2) +
#label the traces
geom_label(data=dfTraceLabels(x = Inflow, y = Release, label = Label), size=5) +
facet_wrap( ~ Elevation) +
#Limit the x-axis to reasonable inflows
#xlim(7,10) +
#Reverse x-axis so go from High to Low
scale_x_reverse(limits = c(10,7)) +
scale_y_continuous(limits = c(0,10), breaks = seq(0,10,by=2), sec.axis = sec_axis(~. +0, name = "", breaks = dfReleaseLabels$Release/1e6, labels = dfReleaseLabels$Label)) +
scale_fill_manual(values = c("Red","Pink", pBlues[4]), labels = c("Mandatory conservation\ntarget", "Additional conservation", "Release")) +
#Add line annotations
#Horizonal line for Havasu Parker
geom_hline(yintercept = dfReleaseLabels$Release[3]/1e6, linetype = "dashed", size = 1.25, color = pBlues[9]) +
#Sloped line for release to stabalize level
#geom_abline(slope = -1, intercept =-0.4, linetype = "longdash", size = 2 ) +
theme_bw() +
labs(x="Inflow (MAF per year)", y="Release\n(MAF per year)", fill="") +
#theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
#      legend.position = c(0.8,0.7))
theme(text = element_text(size=20), legend.text=element_text(size=18))
ggplot(data = dfReleaseToStabilizeMelt %>% filter(Elevation %in% c("1025","1090"))) +
#The main types
geom_area(aes(x=Inflow/1e6, y=value/1e6, fill=variable)) +
#Overplot a line for the line of releases to stabilize inflow
geom_line(data=dfReleaseToStabilize %>% filter(Elevation %in% c("1025","1090")), aes(x=Inflow/1e6, y = ReleaseToStabilize/1e6), linetype = "longdash", size = 2) +
#label the traces
geom_label(data=dfTraceLabels, aes(x = Inflow, y = Release, label = Label), size=5) +
facet_wrap( ~ Elevation) +
#Limit the x-axis to reasonable inflows
#xlim(7,10) +
#Reverse x-axis so go from High to Low
scale_x_reverse(limits = c(10,7)) +
scale_y_continuous(limits = c(0,10), breaks = seq(0,10,by=2), sec.axis = sec_axis(~. +0, name = "", breaks = dfReleaseLabels$Release/1e6, labels = dfReleaseLabels$Label)) +
scale_fill_manual(values = c("Red","Pink", pBlues[4]), labels = c("Mandatory conservation\ntarget", "Additional conservation", "Release")) +
#Add line annotations
#Horizonal line for Havasu Parker
geom_hline(yintercept = dfReleaseLabels$Release[3]/1e6, linetype = "dashed", size = 1.25, color = pBlues[9]) +
#Sloped line for release to stabalize level
#geom_abline(slope = -1, intercept =-0.4, linetype = "longdash", size = 2 ) +
theme_bw() +
labs(x="Inflow (MAF per year)", y="Release\n(MAF per year)", fill="") +
#theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
#      legend.position = c(0.8,0.7))
theme(text = element_text(size=20), legend.text=element_text(size=18))
dfTraceLabels <- data.frame(Elevation=1090,Inflow = c(8.5,8,8.5), Release = c(9.6-0.3/2, 8.3, 5), Label=c("Mandatory conservation", "Additional\nconservation", "Release"))
#Calculate the additional conservation needed beyond DCP target
dfReleaseToStabilize$AdditionalConservation <- dfReleaseToStabilize$DeliveryTarget  - dfReleaseToStabilize$MandatoryConservationTarget - dfReleaseToStabilize$Release
dfReleaseToStabilize$AdditionalConservation <- ifelse(dfReleaseToStabilize$AdditionalConservation < 0, 0, dfReleaseToStabilize$AdditionalConservation)
#Melt the selected plot columns
dfReleaseToStabilizeMelt <- melt(dfReleaseToStabilize, id.vars = c("Elevation", "Volume", "Inflow"), measure.vars = c("MandatoryConservationTarget","AdditionalConservation","Release") )
#Create a data frame to right label the y-axis
dfReleaseLabels <- data.frame(Release = c(vLowerBasinDeliveryTarget,vLowerBasinDeliveryTarget - max(dfReleaseToStabilize$MandatoryConservationTarget),600000),
Label = c("Target\nrelease","Max. mandatory\n conservation", "Havasu/Parker\nevap. + ET"))
ggplot(data = dfReleaseToStabilizeMelt %>% filter(Elevation %in% c("1025","1090"))) +
#The main types
geom_area(aes(x=Inflow/1e6, y=value/1e6, fill=variable)) +
#Overplot a line for the line of releases to stabilize inflow
geom_line(data=dfReleaseToStabilize %>% filter(Elevation %in% c("1025","1090")), aes(x=Inflow/1e6, y = ReleaseToStabilize/1e6), linetype = "longdash", size = 2) +
#label the traces
geom_text(data=dfTraceLabels, aes(x = Inflow, y = Release, label = Label), size=5) +
facet_wrap( ~ Elevation) +
#Limit the x-axis to reasonable inflows
#xlim(7,10) +
#Reverse x-axis so go from High to Low
scale_x_reverse(limits = c(10,7)) +
scale_y_continuous(limits = c(0,10), breaks = seq(0,10,by=2), sec.axis = sec_axis(~. +0, name = "", breaks = dfReleaseLabels$Release/1e6, labels = dfReleaseLabels$Label)) +
scale_fill_manual(values = c("Red","Pink", pBlues[4]), labels = c("Mandatory conservation\ntarget", "Additional conservation", "Release")) +
#Add line annotations
#Horizonal line for Havasu Parker
geom_hline(yintercept = dfReleaseLabels$Release[3]/1e6, linetype = "dashed", size = 1.25, color = pBlues[9]) +
#Sloped line for release to stabalize level
#geom_abline(slope = -1, intercept =-0.4, linetype = "longdash", size = 2 ) +
theme_bw() +
labs(x="Inflow (MAF per year)", y="Release\n(MAF per year)", fill="") +
#theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
#      legend.position = c(0.8,0.7))
theme(text = element_text(size=20), legend.text=element_text(size=18))
dfTraceLabels <- data.frame(Elevation=1090,Inflow = c(8.5,7.5,8.5), Release = c(9.6-0.3/2, 8.3, 5), Label=c("Mandatory conservation", "Additional\nconservation", "Release"))
#Calculate the additional conservation needed beyond DCP target
dfReleaseToStabilize$AdditionalConservation <- dfReleaseToStabilize$DeliveryTarget  - dfReleaseToStabilize$MandatoryConservationTarget - dfReleaseToStabilize$Release
dfReleaseToStabilize$AdditionalConservation <- ifelse(dfReleaseToStabilize$AdditionalConservation < 0, 0, dfReleaseToStabilize$AdditionalConservation)
#Melt the selected plot columns
dfReleaseToStabilizeMelt <- melt(dfReleaseToStabilize, id.vars = c("Elevation", "Volume", "Inflow"), measure.vars = c("MandatoryConservationTarget","AdditionalConservation","Release") )
#Create a data frame to right label the y-axis
dfReleaseLabels <- data.frame(Release = c(vLowerBasinDeliveryTarget,vLowerBasinDeliveryTarget - max(dfReleaseToStabilize$MandatoryConservationTarget),600000),
Label = c("Target\nrelease","Max. mandatory\n conservation", "Havasu/Parker\nevap. + ET"))
ggplot(data = dfReleaseToStabilizeMelt %>% filter(Elevation %in% c("1025","1090"))) +
#The main types
geom_area(aes(x=Inflow/1e6, y=value/1e6, fill=variable)) +
#Overplot a line for the line of releases to stabilize inflow
geom_line(data=dfReleaseToStabilize %>% filter(Elevation %in% c("1025","1090")), aes(x=Inflow/1e6, y = ReleaseToStabilize/1e6), linetype = "longdash", size = 2) +
#label the traces
geom_text(data=dfTraceLabels, aes(x = Inflow, y = Release, label = Label), size=5) +
facet_wrap( ~ Elevation) +
#Limit the x-axis to reasonable inflows
#xlim(7,10) +
#Reverse x-axis so go from High to Low
scale_x_reverse(limits = c(10,7)) +
scale_y_continuous(limits = c(0,10), breaks = seq(0,10,by=2), sec.axis = sec_axis(~. +0, name = "", breaks = dfReleaseLabels$Release/1e6, labels = dfReleaseLabels$Label)) +
#scale_fill_manual(values = c("Red","Pink", pBlues[4]), labels = c("Mandatory conservation\ntarget", "Additional conservation", "Release")) +
#Add line annotations
#Horizonal line for Havasu Parker
geom_hline(yintercept = dfReleaseLabels$Release[3]/1e6, linetype = "dashed", size = 1.25, color = pBlues[9]) +
#Sloped line for release to stabalize level
#geom_abline(slope = -1, intercept =-0.4, linetype = "longdash", size = 2 ) +
theme_bw() +
labs(x="Inflow (MAF per year)", y="Release\n(MAF per year)", fill="") +
#theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
#      legend.position = c(0.8,0.7))
theme(text = element_text(size=20), legend.text=element_text(size=18), legend.position = "none")
ggplot(data = dfReleaseToStabilizeMelt %>% filter(Elevation %in% c("1025","1090"))) +
#The main types
geom_area(aes(x=Inflow/1e6, y=value/1e6, fill=variable)) +
#Overplot a line for the line of releases to stabilize inflow
geom_line(data=dfReleaseToStabilize %>% filter(Elevation %in% c("1025","1090")), aes(x=Inflow/1e6, y = ReleaseToStabilize/1e6), linetype = "longdash", size = 2) +
#label the traces
geom_text(data=dfTraceLabels, aes(x = Inflow, y = Release, label = Label), size=5) +
facet_wrap( ~ Elevation) +
#Limit the x-axis to reasonable inflows
#xlim(7,10) +
#Reverse x-axis so go from High to Low
scale_x_reverse(limits = c(10,7)) +
scale_y_continuous(limits = c(0,10), breaks = seq(0,10,by=2), sec.axis = sec_axis(~. +0, name = "", breaks = dfReleaseLabels$Release/1e6, labels = dfReleaseLabels$Label)) +
scale_fill_manual(values = c("Red","Pink", pBlues[4]), labels = c("Mandatory conservation\ntarget", "Additional conservation", "Release")) +
#Add line annotations
#Horizonal line for Havasu Parker
geom_hline(yintercept = dfReleaseLabels$Release[3]/1e6, linetype = "dashed", size = 1.25, color = pBlues[9]) +
#Sloped line for release to stabalize level
#geom_abline(slope = -1, intercept =-0.4, linetype = "longdash", size = 2 ) +
theme_bw() +
labs(x="Inflow (MAF per year)", y="Release\n(MAF per year)", fill="") +
#theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
#      legend.position = c(0.8,0.7))
theme(text = element_text(size=20), legend.text=element_text(size=18), legend.position = "none")
ggplot(data = dfReleaseToStabilizeMelt %>% filter(Elevation %in% c("1025","1090"))) +
#The main types
geom_area(aes(x=Inflow/1e6, y=value/1e6, fill=variable)) +
#Overplot a line for the line of releases to stabilize inflow
geom_line(data=dfReleaseToStabilize %>% filter(Elevation %in% c("1025","1090")), aes(x=Inflow/1e6, y = ReleaseToStabilize/1e6), linetype = "longdash", size = 2) +
#label the traces
geom_text(data=dfTraceLabels, aes(x = Inflow, y = Release, label = Label), size=7) +
facet_wrap( ~ Elevation) +
#Limit the x-axis to reasonable inflows
#xlim(7,10) +
#Reverse x-axis so go from High to Low
scale_x_reverse(limits = c(10,7)) +
scale_y_continuous(limits = c(0,10), breaks = seq(0,10,by=2), sec.axis = sec_axis(~. +0, name = "", breaks = dfReleaseLabels$Release/1e6, labels = dfReleaseLabels$Label)) +
scale_fill_manual(values = c("Red","Pink", pBlues[4]), labels = c("Mandatory conservation\ntarget", "Additional conservation", "Release")) +
#Add line annotations
#Horizonal line for Havasu Parker
geom_hline(yintercept = dfReleaseLabels$Release[3]/1e6, linetype = "dashed", size = 1.25, color = pBlues[9]) +
#Sloped line for release to stabalize level
#geom_abline(slope = -1, intercept =-0.4, linetype = "longdash", size = 2 ) +
theme_bw() +
labs(x="Inflow (MAF per year)", y="Release\n(MAF per year)", fill="") +
#theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
#      legend.position = c(0.8,0.7))
theme(text = element_text(size=20), legend.text=element_text(size=18), legend.position = "none")
ggplot(data = dfReleaseToStabilizeMelt %>% filter(Elevation %in% c("1025","1090"))) +
#The main types
geom_area(aes(x=Inflow/1e6, y=value/1e6, fill=variable)) +
#Overplot a line for the line of releases to stabilize inflow
geom_line(data=dfReleaseToStabilize %>% filter(Elevation %in% c("1025","1090")), aes(x=Inflow/1e6, y = ReleaseToStabilize/1e6), linetype = "longdash", size = 2) +
#label the traces
geom_text(data=dfTraceLabels, aes(x = Inflow, y = Release, label = Label), size=6) +
facet_wrap( ~ Elevation) +
#Limit the x-axis to reasonable inflows
#xlim(7,10) +
#Reverse x-axis so go from High to Low
scale_x_reverse(limits = c(10,7)) +
scale_y_continuous(limits = c(0,10), breaks = seq(0,10,by=2), sec.axis = sec_axis(~. +0, name = "", breaks = dfReleaseLabels$Release/1e6, labels = dfReleaseLabels$Label)) +
scale_fill_manual(values = c("Red","Pink", pBlues[4]), labels = c("Mandatory conservation\ntarget", "Additional conservation", "Release")) +
#Add line annotations
#Horizonal line for Havasu Parker
geom_hline(yintercept = dfReleaseLabels$Release[3]/1e6, linetype = "dashed", size = 1.25, color = pBlues[9]) +
#Sloped line for release to stabalize level
#geom_abline(slope = -1, intercept =-0.4, linetype = "longdash", size = 2 ) +
theme_bw() +
labs(x="Inflow (MAF per year)", y="Release\n(MAF per year)", fill="") +
#theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18),
#      legend.position = c(0.8,0.7))
theme(text = element_text(size=20), legend.text=element_text(size=18), legend.position = "none")
