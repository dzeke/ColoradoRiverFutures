#geom_area(data=dfPlotData,aes(x=month,y=stor_maf, fill = variable), position='stack') +
#scale_fill_manual(values = palBlues[7:-1:2]) +
geom_line(data=dfReservedFlood,aes(x=month_num, y=Powell_flood_stor, group = 1), size=2) +
#Label the levels within the equalization tiers
#geom_text(data=dfReleases, aes( x = MidPowell, y = MidMead, label = Release), angle = 0, size = 6) +
#Create secondary axes for Lake Levels
# Can't figure out why dfMeadTiers$Volume does not work!!!! Hard coding ...
#ylim(0,dfPlotData[1,c("stor_maf")]+1) +
#scale_y_continuous(breaks = c(0,5,10,15,20,25),labels=c(0,5,10,15, 20,25),  sec.axis = sec_axis(~. +0, name = "Mead Level (feet)", breaks = LevelsAsTicks$stor_maf, labels = round(LevelsAsTicks$level,1))) +
scale_y_continuous(breaks = c(0,5,10,15,20,25),labels=c(0,5,10,15, 20,25),  sec.axis = sec_axis(~. +0, name = "Elevation (feet)", breaks = dfPowellPoolsPlot$stor_maf, labels = dfPowellPoolsPlot$label)) +
#    scale_y_continuous(breaks = c(0,5.98,9.6,12.2,dfMaxStor[2,2]),labels=c(0,5.98,9.6,12.2,dfMaxStor[2,2]),  sec.axis = sec_axis(~. +0, name = "Mead Level (feet)", breaks = c(0,5.98,9.6,12.2,dfMaxStor[2,2]), labels = c(895,1025,1075,1105,1218.8))) +
#scale_x_discrete(breaks=cMonths, labels= cMonthsLabels) +
scale_x_continuous(breaks=cMonths, labels= cMonthsLabels) +
#scale_fill_manual(breaks=c(1:6),values = palBlues[2:7]) + #,labels = variable) +
theme_bw() +
#coord_fixed() +
labs(x="", y="Active Storage (MAF)", fill = "Pool") +
theme(text = element_text(size=20), legend.title=element_blank(), legend.text=element_text(size=18), legend.position = "none")
ggsave("PowellPools.png", width=9, height = 6.5, units="in")
### DER January 31, 2020 - Plot Reservoir Storage over time
### Mead, Powell, All onn same plot including total system storage
##### #5. Plot historical MEAD Pool Levels/Volumes over time
# Select the pools
dStartDate <- min(dfMeadHist$BeginOfMon)
dEndDate <- max(dfMeadHist$BeginOfMon)
cMeadVarNames <- c("Dead Pool", "SNWA Intake #1", "ISG trigger", "DCP trigger", "Live Capacity")
dfMeadPoolsMonthly <- dfMeadPoolsPlot %>% filter(name %in% cMeadVarNames) %>% arrange(-level)
dfMeadPoolsMonthly$month <- dStartDate
dfMeadPoolsMonthly$EndMonth <- dEndDate
dfMeadPoolsMonthlyMelt <- melt(dfMeadPoolsMonthly[,c("Reservoir","name","level","stor_maf","month","EndMonth")],id.vars = c("Reservoir","name","level","stor_maf"))
dfMeadPoolsMonthlyMelt$Month <- dfMeadPoolsMonthlyMelt$value
dfMeadPoolsMonthlyMelt <- dfMeadPoolsMonthlyMelt[,-c(5,6)]
dfPlotData <- dfMeadPoolsMonthlyMelt %>% arrange(-level,Month)
# Calculate new flood pools as a function of empty upstream storage
MaxMeadFloodPool <- max(dfReservedFlood$Mead_flood_stor)
cFillContours <- c(1,2,3)
cFillNames <- c("one","two","three","four")
nRowsPools <- nrow(dfReservedFlood)
dfFloodPools <- as.data.frame(dfReservedFlood[,c("month_num")])
dfFloodPools$'0' <- dfReservedFlood$Mead_flood_stor
dfFloodPools$'1' <- 0
dfFloodPools$'2' <- 0
dfFloodPools$'3' <- 0
for (contour in cFillContours) {
#Credit the empty upstream storage
dfFloodPools[,contour+2] <- dfReservedFlood$Mead_flood_stor + cFillContours[contour]
#Maintain a minimum flood pool
for (iRow in  (1:nrow(dfFloodPools))) {
dfFloodPools[iRow,contour+2] <- min(dfFloodPools[iRow,contour+2], MaxMeadFloodPool)
}
}
#Melt the contour data
dfFloodPoolsMelt <- melt(dfFloodPools,id.vars = c("month_num"))
#Adjust the right level ticks
dfMeadPoolsPlot2 <- dfMeadPoolsPlot
dfMeadPoolsPlot2[9,8] <- "1192 - Max. Req. Flood Pool"
dfMeadPoolsPlot2[10,8] <- "1218 - Min. Req. Flood Pool"
#Create the month ticks
cMonths <- 1:12
cMonthsLabels <- month.abb[cMonths]
ggplot() +
#Zone levels
geom_line(data=dfPlotData,aes(x=Month,y=stor_maf, color = name), size=1.25) +
#Mead storage
geom_line(data=dfMeadHist,aes(x=BeginOfMon,y=Stor/1e6), size=2) +
scale_color_manual(values = palBlues[10:-1:2]) +
#geom_area(data=dfPlotData,aes(x=month,y=stor_maf, fill = variable), position='stack') +
#scale_fill_manual(values = palBlues[7:-1:2]) +
#Flood pools as a function of upstream storage
#geom_line(data=dfFloodPoolsMelt,aes(x=month_num, y=value, group = variable), size=1) +
#Label the flood pool contours of empty upstream storage
#geom_label(data=dfFloodPoolsMelt %>% filter(month_num %in% c(3,11)), aes( x = month_num, y = value, label = variable, fontface="bold"), size=5, angle = 0) +
#geom_label(aes( x = 7, y = 23, label = "[MAF of empty upstream storage]", fontface="bold"), label.size = 0, size=5, angle = 0) +
scale_y_continuous(breaks = c(0,5,10,15,20,25),labels=c(0,5,10,15, 20,25),  sec.axis = sec_axis(~. +0, name = "Elevation (feet)", breaks = dfMeadPoolsPlot2$stor_maf, labels = dfMeadPoolsPlot2$label)) +
#    scale_y_continuous(breaks = c(0,5.98,9.6,12.2,dfMaxStor[2,2]),labels=c(0,5.98,9.6,12.2,dfMaxStor[2,2]),  sec.axis = sec_axis(~. +0, name = "Mead Level (feet)", breaks = c(0,5.98,9.6,12.2,dfMaxStor[2,2]), labels = c(895,1025,1075,1105,1218.8))) +
#scale_x_discrete(breaks=cMonths, labels= cMonthsLabels) +
#scale_x_continuous(breaks=seq(1960,2020,by=10)) +
#scale_fill_manual(breaks=c(1:6),values = palBlues[2:7]) + #,labels = variable) +
theme_bw() +
#coord_fixed() +
labs(x="", y="Mead Active Storage (MAF)", fill = "Pool") +
theme(text = element_text(size=20), legend.title=element_blank(),
legend.text=element_text(size=18), legend.position = "none",
axis.text.x = element_text(size=18))
View(dfMeadPoolsPlot2)
dfMeadPoolsPlot2 <- dfMeadPoolsPlot2[c(seq(1,5),seq(7:11)),]
dfMeadPoolsPlot2 <- dfMeadPoolsPlot
dfMeadPoolsPlot2[9,8] <- "1192 - Max. Req. Flood Pool"
dfMeadPoolsPlot2[10,8] <- "1218 - Min. Req. Flood Pool"
c(seq(1,5),seq(7:11))
c(seq(1,5),seq(7,11))
dfMeadPoolsPlot2 <- dfMeadPoolsPlot2[c(seq(1,5),seq(7,11)),]
cMonths <- 1:12
cMonthsLabels <- month.abb[cMonths]
ggplot() +
#Zone levels
geom_line(data=dfPlotData,aes(x=Month,y=stor_maf, color = name), size=1.25) +
#Mead storage
geom_line(data=dfMeadHist,aes(x=BeginOfMon,y=Stor/1e6), size=2) +
scale_color_manual(values = palBlues[10:-1:2]) +
#geom_area(data=dfPlotData,aes(x=month,y=stor_maf, fill = variable), position='stack') +
#scale_fill_manual(values = palBlues[7:-1:2]) +
#Flood pools as a function of upstream storage
#geom_line(data=dfFloodPoolsMelt,aes(x=month_num, y=value, group = variable), size=1) +
#Label the flood pool contours of empty upstream storage
#geom_label(data=dfFloodPoolsMelt %>% filter(month_num %in% c(3,11)), aes( x = month_num, y = value, label = variable, fontface="bold"), size=5, angle = 0) +
#geom_label(aes( x = 7, y = 23, label = "[MAF of empty upstream storage]", fontface="bold"), label.size = 0, size=5, angle = 0) +
scale_y_continuous(breaks = c(0,5,10,15,20,25),labels=c(0,5,10,15, 20,25),  sec.axis = sec_axis(~. +0, name = "Elevation (feet)", breaks = dfMeadPoolsPlot2$stor_maf, labels = dfMeadPoolsPlot2$label)) +
#    scale_y_continuous(breaks = c(0,5.98,9.6,12.2,dfMaxStor[2,2]),labels=c(0,5.98,9.6,12.2,dfMaxStor[2,2]),  sec.axis = sec_axis(~. +0, name = "Mead Level (feet)", breaks = c(0,5.98,9.6,12.2,dfMaxStor[2,2]), labels = c(895,1025,1075,1105,1218.8))) +
#scale_x_discrete(breaks=cMonths, labels= cMonthsLabels) +
#scale_x_continuous(breaks=seq(1960,2020,by=10)) +
#scale_fill_manual(breaks=c(1:6),values = palBlues[2:7]) + #,labels = variable) +
theme_bw() +
#coord_fixed() +
labs(x="", y="Mead Active Storage (MAF)", fill = "Pool") +
theme(text = element_text(size=20), legend.title=element_blank(),
legend.text=element_text(size=18), legend.position = "none",
axis.text.x = element_text(size=18))
View(dfPlotData)
View(dfPlotData)
ggplot() +
#Zone levels
geom_line(data=dfPlotData,aes(x=Month,y=stor_maf, group = name, color = name), size=1.25) +
#Mead storage
geom_line(data=dfMeadHist,aes(x=BeginOfMon,y=Stor/1e6), size=2) +
scale_color_manual(values = palBlues[10:-1:2]) +
#geom_area(data=dfPlotData,aes(x=month,y=stor_maf, fill = variable), position='stack') +
#scale_fill_manual(values = palBlues[7:-1:2]) +
#Flood pools as a function of upstream storage
#geom_line(data=dfFloodPoolsMelt,aes(x=month_num, y=value, group = variable), size=1) +
#Label the flood pool contours of empty upstream storage
#geom_label(data=dfFloodPoolsMelt %>% filter(month_num %in% c(3,11)), aes( x = month_num, y = value, label = variable, fontface="bold"), size=5, angle = 0) +
#geom_label(aes( x = 7, y = 23, label = "[MAF of empty upstream storage]", fontface="bold"), label.size = 0, size=5, angle = 0) +
scale_y_continuous(breaks = c(0,5,10,15,20,25),labels=c(0,5,10,15, 20,25),  sec.axis = sec_axis(~. +0, name = "Elevation (feet)", breaks = dfMeadPoolsPlot2$stor_maf, labels = dfMeadPoolsPlot2$label)) +
#    scale_y_continuous(breaks = c(0,5.98,9.6,12.2,dfMaxStor[2,2]),labels=c(0,5.98,9.6,12.2,dfMaxStor[2,2]),  sec.axis = sec_axis(~. +0, name = "Mead Level (feet)", breaks = c(0,5.98,9.6,12.2,dfMaxStor[2,2]), labels = c(895,1025,1075,1105,1218.8))) +
#scale_x_discrete(breaks=cMonths, labels= cMonthsLabels) +
#scale_x_continuous(breaks=seq(1960,2020,by=10)) +
#scale_fill_manual(breaks=c(1:6),values = palBlues[2:7]) + #,labels = variable) +
theme_bw() +
#coord_fixed() +
labs(x="", y="Mead Active Storage (MAF)", fill = "Pool") +
theme(text = element_text(size=20), legend.title=element_blank(),
legend.text=element_text(size=18), legend.position = "none",
axis.text.x = element_text(size=18))
ggplot() +
#Zone levels
geom_line(data=dfPlotData,aes(x=Month,y=stor_maf, group = name, color = name), size=1.25) +
#Mead storage
geom_line(data=dfMeadHist,aes(x=BeginOfMon,y=Stor/1e6), size=2) +
#scale_color_manual(values = palBlues[10:-1:2]) +
#geom_area(data=dfPlotData,aes(x=month,y=stor_maf, fill = variable), position='stack') +
#scale_fill_manual(values = palBlues[7:-1:2]) +
#Flood pools as a function of upstream storage
#geom_line(data=dfFloodPoolsMelt,aes(x=month_num, y=value, group = variable), size=1) +
#Label the flood pool contours of empty upstream storage
#geom_label(data=dfFloodPoolsMelt %>% filter(month_num %in% c(3,11)), aes( x = month_num, y = value, label = variable, fontface="bold"), size=5, angle = 0) +
#geom_label(aes( x = 7, y = 23, label = "[MAF of empty upstream storage]", fontface="bold"), label.size = 0, size=5, angle = 0) +
scale_y_continuous(breaks = c(0,5,10,15,20,25),labels=c(0,5,10,15, 20,25),  sec.axis = sec_axis(~. +0, name = "Elevation (feet)", breaks = dfMeadPoolsPlot2$stor_maf, labels = dfMeadPoolsPlot2$label)) +
#    scale_y_continuous(breaks = c(0,5.98,9.6,12.2,dfMaxStor[2,2]),labels=c(0,5.98,9.6,12.2,dfMaxStor[2,2]),  sec.axis = sec_axis(~. +0, name = "Mead Level (feet)", breaks = c(0,5.98,9.6,12.2,dfMaxStor[2,2]), labels = c(895,1025,1075,1105,1218.8))) +
#scale_x_discrete(breaks=cMonths, labels= cMonthsLabels) +
#scale_x_continuous(breaks=seq(1960,2020,by=10)) +
#scale_fill_manual(breaks=c(1:6),values = palBlues[2:7]) + #,labels = variable) +
theme_bw() +
#coord_fixed() +
labs(x="", y="Mead Active Storage (MAF)", fill = "Pool") +
theme(text = element_text(size=20), legend.title=element_blank(),
legend.text=element_text(size=18), legend.position = "none",
axis.text.x = element_text(size=18))
ggplot() +
#Zone levels
geom_line(data=dfPlotData,aes(x=Month,y=stor_maf, group = name, color = name), size=1.25) +
#Mead storage
geom_line(data=dfMeadHist,aes(x=BeginOfMon,y=Stor/1e6), size=2) +
scale_color_manual(values = palBlues[10:-1:5]) +
#geom_area(data=dfPlotData,aes(x=month,y=stor_maf, fill = variable), position='stack') +
#scale_fill_manual(values = palBlues[7:-1:2]) +
#Flood pools as a function of upstream storage
#geom_line(data=dfFloodPoolsMelt,aes(x=month_num, y=value, group = variable), size=1) +
#Label the flood pool contours of empty upstream storage
#geom_label(data=dfFloodPoolsMelt %>% filter(month_num %in% c(3,11)), aes( x = month_num, y = value, label = variable, fontface="bold"), size=5, angle = 0) +
#geom_label(aes( x = 7, y = 23, label = "[MAF of empty upstream storage]", fontface="bold"), label.size = 0, size=5, angle = 0) +
scale_y_continuous(breaks = c(0,5,10,15,20,25),labels=c(0,5,10,15, 20,25),  sec.axis = sec_axis(~. +0, name = "Elevation (feet)", breaks = dfMeadPoolsPlot2$stor_maf, labels = dfMeadPoolsPlot2$label)) +
#    scale_y_continuous(breaks = c(0,5.98,9.6,12.2,dfMaxStor[2,2]),labels=c(0,5.98,9.6,12.2,dfMaxStor[2,2]),  sec.axis = sec_axis(~. +0, name = "Mead Level (feet)", breaks = c(0,5.98,9.6,12.2,dfMaxStor[2,2]), labels = c(895,1025,1075,1105,1218.8))) +
#scale_x_discrete(breaks=cMonths, labels= cMonthsLabels) +
#scale_x_continuous(breaks=seq(1960,2020,by=10)) +
#scale_fill_manual(breaks=c(1:6),values = palBlues[2:7]) + #,labels = variable) +
theme_bw() +
#coord_fixed() +
labs(x="", y="Mead Active Storage (MAF)", fill = "Pool") +
theme(text = element_text(size=20), legend.title=element_blank(),
legend.text=element_text(size=18), legend.position = "none",
axis.text.x = element_text(size=18))
ggplot() +
#Zone levels
geom_line(data=dfPlotData,aes(x=Month,y=stor_maf, group = name, color = name), size=1.25) +
#Mead storage
geom_line(data=dfMeadHist,aes(x=BeginOfMon,y=Stor/1e6), size=2) +
scale_color_manual(values = palBlues[c(10,8,6,4,2)]) +
#geom_area(data=dfPlotData,aes(x=month,y=stor_maf, fill = variable), position='stack') +
#scale_fill_manual(values = palBlues[7:-1:2]) +
#Flood pools as a function of upstream storage
#geom_line(data=dfFloodPoolsMelt,aes(x=month_num, y=value, group = variable), size=1) +
#Label the flood pool contours of empty upstream storage
#geom_label(data=dfFloodPoolsMelt %>% filter(month_num %in% c(3,11)), aes( x = month_num, y = value, label = variable, fontface="bold"), size=5, angle = 0) +
#geom_label(aes( x = 7, y = 23, label = "[MAF of empty upstream storage]", fontface="bold"), label.size = 0, size=5, angle = 0) +
scale_y_continuous(breaks = c(0,5,10,15,20,25),labels=c(0,5,10,15, 20,25),  sec.axis = sec_axis(~. +0, name = "Elevation (feet)", breaks = dfMeadPoolsPlot2$stor_maf, labels = dfMeadPoolsPlot2$label)) +
#    scale_y_continuous(breaks = c(0,5.98,9.6,12.2,dfMaxStor[2,2]),labels=c(0,5.98,9.6,12.2,dfMaxStor[2,2]),  sec.axis = sec_axis(~. +0, name = "Mead Level (feet)", breaks = c(0,5.98,9.6,12.2,dfMaxStor[2,2]), labels = c(895,1025,1075,1105,1218.8))) +
#scale_x_discrete(breaks=cMonths, labels= cMonthsLabels) +
#scale_x_continuous(breaks=seq(1960,2020,by=10)) +
#scale_fill_manual(breaks=c(1:6),values = palBlues[2:7]) + #,labels = variable) +
theme_bw() +
#coord_fixed() +
labs(x="", y="Mead Active Storage (MAF)", fill = "Pool") +
theme(text = element_text(size=20), legend.title=element_blank(),
legend.text=element_text(size=18), legend.position = "none",
axis.text.x = element_text(size=18))
ggplot() +
#Zone levels
geom_line(data=dfPlotData,aes(x=Month,y=stor_maf, group = level, color = name), size=1.25) +
#Mead storage
geom_line(data=dfMeadHist,aes(x=BeginOfMon,y=Stor/1e6), size=2) +
scale_color_manual(values = palBlues[c(10,8,6,4,2)]) +
#geom_area(data=dfPlotData,aes(x=month,y=stor_maf, fill = variable), position='stack') +
#scale_fill_manual(values = palBlues[7:-1:2]) +
#Flood pools as a function of upstream storage
#geom_line(data=dfFloodPoolsMelt,aes(x=month_num, y=value, group = variable), size=1) +
#Label the flood pool contours of empty upstream storage
#geom_label(data=dfFloodPoolsMelt %>% filter(month_num %in% c(3,11)), aes( x = month_num, y = value, label = variable, fontface="bold"), size=5, angle = 0) +
#geom_label(aes( x = 7, y = 23, label = "[MAF of empty upstream storage]", fontface="bold"), label.size = 0, size=5, angle = 0) +
scale_y_continuous(breaks = c(0,5,10,15,20,25),labels=c(0,5,10,15, 20,25),  sec.axis = sec_axis(~. +0, name = "Elevation (feet)", breaks = dfMeadPoolsPlot2$stor_maf, labels = dfMeadPoolsPlot2$label)) +
#    scale_y_continuous(breaks = c(0,5.98,9.6,12.2,dfMaxStor[2,2]),labels=c(0,5.98,9.6,12.2,dfMaxStor[2,2]),  sec.axis = sec_axis(~. +0, name = "Mead Level (feet)", breaks = c(0,5.98,9.6,12.2,dfMaxStor[2,2]), labels = c(895,1025,1075,1105,1218.8))) +
#scale_x_discrete(breaks=cMonths, labels= cMonthsLabels) +
#scale_x_continuous(breaks=seq(1960,2020,by=10)) +
#scale_fill_manual(breaks=c(1:6),values = palBlues[2:7]) + #,labels = variable) +
theme_bw() +
#coord_fixed() +
labs(x="", y="Mead Active Storage (MAF)", fill = "Pool") +
theme(text = element_text(size=20), legend.title=element_blank(),
legend.text=element_text(size=18), legend.position = "none",
axis.text.x = element_text(size=18))
ggplot() +
#Zone levels
geom_line(data=dfPlotData,aes(x=Month,y=stor_maf, group = level, color = level), size=1.25) +
#Mead storage
geom_line(data=dfMeadHist,aes(x=BeginOfMon,y=Stor/1e6), size=2) +
scale_color_manual(values = palBlues[c(10,8,6,4,2)]) +
#geom_area(data=dfPlotData,aes(x=month,y=stor_maf, fill = variable), position='stack') +
#scale_fill_manual(values = palBlues[7:-1:2]) +
#Flood pools as a function of upstream storage
#geom_line(data=dfFloodPoolsMelt,aes(x=month_num, y=value, group = variable), size=1) +
#Label the flood pool contours of empty upstream storage
#geom_label(data=dfFloodPoolsMelt %>% filter(month_num %in% c(3,11)), aes( x = month_num, y = value, label = variable, fontface="bold"), size=5, angle = 0) +
#geom_label(aes( x = 7, y = 23, label = "[MAF of empty upstream storage]", fontface="bold"), label.size = 0, size=5, angle = 0) +
scale_y_continuous(breaks = c(0,5,10,15,20,25),labels=c(0,5,10,15, 20,25),  sec.axis = sec_axis(~. +0, name = "Elevation (feet)", breaks = dfMeadPoolsPlot2$stor_maf, labels = dfMeadPoolsPlot2$label)) +
#    scale_y_continuous(breaks = c(0,5.98,9.6,12.2,dfMaxStor[2,2]),labels=c(0,5.98,9.6,12.2,dfMaxStor[2,2]),  sec.axis = sec_axis(~. +0, name = "Mead Level (feet)", breaks = c(0,5.98,9.6,12.2,dfMaxStor[2,2]), labels = c(895,1025,1075,1105,1218.8))) +
#scale_x_discrete(breaks=cMonths, labels= cMonthsLabels) +
#scale_x_continuous(breaks=seq(1960,2020,by=10)) +
#scale_fill_manual(breaks=c(1:6),values = palBlues[2:7]) + #,labels = variable) +
theme_bw() +
#coord_fixed() +
labs(x="", y="Mead Active Storage (MAF)", fill = "Pool") +
theme(text = element_text(size=20), legend.title=element_blank(),
legend.text=element_text(size=18), legend.position = "none",
axis.text.x = element_text(size=18))
ggplot() +
#Zone levels
geom_line(data=dfPlotData,aes(x=Month,y=stor_maf, color = as.factor(level)), size=1.25) +
#Mead storage
geom_line(data=dfMeadHist,aes(x=BeginOfMon,y=Stor/1e6), size=2) +
scale_color_manual(values = palBlues[c(10,8,6,4,2)]) +
#geom_area(data=dfPlotData,aes(x=month,y=stor_maf, fill = variable), position='stack') +
#scale_fill_manual(values = palBlues[7:-1:2]) +
#Flood pools as a function of upstream storage
#geom_line(data=dfFloodPoolsMelt,aes(x=month_num, y=value, group = variable), size=1) +
#Label the flood pool contours of empty upstream storage
#geom_label(data=dfFloodPoolsMelt %>% filter(month_num %in% c(3,11)), aes( x = month_num, y = value, label = variable, fontface="bold"), size=5, angle = 0) +
#geom_label(aes( x = 7, y = 23, label = "[MAF of empty upstream storage]", fontface="bold"), label.size = 0, size=5, angle = 0) +
scale_y_continuous(breaks = c(0,5,10,15,20,25),labels=c(0,5,10,15, 20,25),  sec.axis = sec_axis(~. +0, name = "Elevation (feet)", breaks = dfMeadPoolsPlot2$stor_maf, labels = dfMeadPoolsPlot2$label)) +
#    scale_y_continuous(breaks = c(0,5.98,9.6,12.2,dfMaxStor[2,2]),labels=c(0,5.98,9.6,12.2,dfMaxStor[2,2]),  sec.axis = sec_axis(~. +0, name = "Mead Level (feet)", breaks = c(0,5.98,9.6,12.2,dfMaxStor[2,2]), labels = c(895,1025,1075,1105,1218.8))) +
#scale_x_discrete(breaks=cMonths, labels= cMonthsLabels) +
#scale_x_continuous(breaks=seq(1960,2020,by=10)) +
#scale_fill_manual(breaks=c(1:6),values = palBlues[2:7]) + #,labels = variable) +
theme_bw() +
#coord_fixed() +
labs(x="", y="Mead Active Storage (MAF)", fill = "Pool") +
theme(text = element_text(size=20), legend.title=element_blank(),
legend.text=element_text(size=18), legend.position = "none",
axis.text.x = element_text(size=18))
ggplot() +
#Zone levels
geom_line(data=dfPlotData,aes(x=Month,y=stor_maf, group = as.facor(level), color = as.factor(level)), size=1.25) +
#Mead storage
geom_line(data=dfMeadHist,aes(x=BeginOfMon,y=Stor/1e6), size=2) +
scale_color_manual(values = palBlues[c(10,8,6,4,2)]) +
#geom_area(data=dfPlotData,aes(x=month,y=stor_maf, fill = variable), position='stack') +
#scale_fill_manual(values = palBlues[7:-1:2]) +
#Flood pools as a function of upstream storage
#geom_line(data=dfFloodPoolsMelt,aes(x=month_num, y=value, group = variable), size=1) +
#Label the flood pool contours of empty upstream storage
#geom_label(data=dfFloodPoolsMelt %>% filter(month_num %in% c(3,11)), aes( x = month_num, y = value, label = variable, fontface="bold"), size=5, angle = 0) +
#geom_label(aes( x = 7, y = 23, label = "[MAF of empty upstream storage]", fontface="bold"), label.size = 0, size=5, angle = 0) +
scale_y_continuous(breaks = c(0,5,10,15,20,25),labels=c(0,5,10,15, 20,25),  sec.axis = sec_axis(~. +0, name = "Elevation (feet)", breaks = dfMeadPoolsPlot2$stor_maf, labels = dfMeadPoolsPlot2$label)) +
#    scale_y_continuous(breaks = c(0,5.98,9.6,12.2,dfMaxStor[2,2]),labels=c(0,5.98,9.6,12.2,dfMaxStor[2,2]),  sec.axis = sec_axis(~. +0, name = "Mead Level (feet)", breaks = c(0,5.98,9.6,12.2,dfMaxStor[2,2]), labels = c(895,1025,1075,1105,1218.8))) +
#scale_x_discrete(breaks=cMonths, labels= cMonthsLabels) +
#scale_x_continuous(breaks=seq(1960,2020,by=10)) +
#scale_fill_manual(breaks=c(1:6),values = palBlues[2:7]) + #,labels = variable) +
theme_bw() +
#coord_fixed() +
labs(x="", y="Mead Active Storage (MAF)", fill = "Pool") +
theme(text = element_text(size=20), legend.title=element_blank(),
legend.text=element_text(size=18), legend.position = "none",
axis.text.x = element_text(size=18))
ggplot() +
#Zone levels
geom_line(data=dfPlotData,aes(x=Month,y=stor_maf, group = as.factor(level), color = as.factor(level)), size=1.25) +
#Mead storage
geom_line(data=dfMeadHist,aes(x=BeginOfMon,y=Stor/1e6), size=2) +
scale_color_manual(values = palBlues[c(10,8,6,4,2)]) +
#geom_area(data=dfPlotData,aes(x=month,y=stor_maf, fill = variable), position='stack') +
#scale_fill_manual(values = palBlues[7:-1:2]) +
#Flood pools as a function of upstream storage
#geom_line(data=dfFloodPoolsMelt,aes(x=month_num, y=value, group = variable), size=1) +
#Label the flood pool contours of empty upstream storage
#geom_label(data=dfFloodPoolsMelt %>% filter(month_num %in% c(3,11)), aes( x = month_num, y = value, label = variable, fontface="bold"), size=5, angle = 0) +
#geom_label(aes( x = 7, y = 23, label = "[MAF of empty upstream storage]", fontface="bold"), label.size = 0, size=5, angle = 0) +
scale_y_continuous(breaks = c(0,5,10,15,20,25),labels=c(0,5,10,15, 20,25),  sec.axis = sec_axis(~. +0, name = "Elevation (feet)", breaks = dfMeadPoolsPlot2$stor_maf, labels = dfMeadPoolsPlot2$label)) +
#    scale_y_continuous(breaks = c(0,5.98,9.6,12.2,dfMaxStor[2,2]),labels=c(0,5.98,9.6,12.2,dfMaxStor[2,2]),  sec.axis = sec_axis(~. +0, name = "Mead Level (feet)", breaks = c(0,5.98,9.6,12.2,dfMaxStor[2,2]), labels = c(895,1025,1075,1105,1218.8))) +
#scale_x_discrete(breaks=cMonths, labels= cMonthsLabels) +
#scale_x_continuous(breaks=seq(1960,2020,by=10)) +
#scale_fill_manual(breaks=c(1:6),values = palBlues[2:7]) + #,labels = variable) +
theme_bw() +
#coord_fixed() +
labs(x="", y="Mead Active Storage (MAF)", fill = "Pool") +
theme(text = element_text(size=20), legend.title=element_blank(),
legend.text=element_text(size=18), legend.position = "none",
axis.text.x = element_text(size=18))
as.factor(dfPlotData$level)
ggplot() +
#Zone levels
geom_line(data=dfPlotData,aes(x=Month,y=stor_maf, group = as.factor(level), color = as.factor(level)), size=1.25) +
#Mead storage
geom_line(data=dfMeadHist,aes(x=BeginOfMon,y=Stor/1e6), size=2) +
scale_color_manual(values = palBlues[c(10,8,7,6,5,3)]) +
#geom_area(data=dfPlotData,aes(x=month,y=stor_maf, fill = variable), position='stack') +
#scale_fill_manual(values = palBlues[7:-1:2]) +
#Flood pools as a function of upstream storage
#geom_line(data=dfFloodPoolsMelt,aes(x=month_num, y=value, group = variable), size=1) +
#Label the flood pool contours of empty upstream storage
#geom_label(data=dfFloodPoolsMelt %>% filter(month_num %in% c(3,11)), aes( x = month_num, y = value, label = variable, fontface="bold"), size=5, angle = 0) +
#geom_label(aes( x = 7, y = 23, label = "[MAF of empty upstream storage]", fontface="bold"), label.size = 0, size=5, angle = 0) +
scale_y_continuous(breaks = c(0,5,10,15,20,25),labels=c(0,5,10,15, 20,25),  sec.axis = sec_axis(~. +0, name = "Elevation (feet)", breaks = dfMeadPoolsPlot2$stor_maf, labels = dfMeadPoolsPlot2$label)) +
#    scale_y_continuous(breaks = c(0,5.98,9.6,12.2,dfMaxStor[2,2]),labels=c(0,5.98,9.6,12.2,dfMaxStor[2,2]),  sec.axis = sec_axis(~. +0, name = "Mead Level (feet)", breaks = c(0,5.98,9.6,12.2,dfMaxStor[2,2]), labels = c(895,1025,1075,1105,1218.8))) +
#scale_x_discrete(breaks=cMonths, labels= cMonthsLabels) +
#scale_x_continuous(breaks=seq(1960,2020,by=10)) +
#scale_fill_manual(breaks=c(1:6),values = palBlues[2:7]) + #,labels = variable) +
theme_bw() +
#coord_fixed() +
labs(x="", y="Mead Active Storage (MAF)", fill = "Pool") +
theme(text = element_text(size=20), legend.title=element_blank(),
legend.text=element_text(size=18), legend.position = "none",
axis.text.x = element_text(size=18))
ggplot() +
#Zone levels
geom_line(data=dfPlotData,aes(x=Month,y=stor_maf, group = as.factor(level), color = as.factor(level)), size=1.25) +
#Mead storage
geom_line(data=dfMeadHist,aes(x=BeginOfMon,y=Stor/1e6), size=2) +
#scale_color_manual(values = palBlues[c(10,8,7,6,5,3)]) +
#geom_area(data=dfPlotData,aes(x=month,y=stor_maf, fill = variable), position='stack') +
#scale_fill_manual(values = palBlues[7:-1:2]) +
#Flood pools as a function of upstream storage
#geom_line(data=dfFloodPoolsMelt,aes(x=month_num, y=value, group = variable), size=1) +
#Label the flood pool contours of empty upstream storage
#geom_label(data=dfFloodPoolsMelt %>% filter(month_num %in% c(3,11)), aes( x = month_num, y = value, label = variable, fontface="bold"), size=5, angle = 0) +
#geom_label(aes( x = 7, y = 23, label = "[MAF of empty upstream storage]", fontface="bold"), label.size = 0, size=5, angle = 0) +
scale_y_continuous(breaks = c(0,5,10,15,20,25),labels=c(0,5,10,15, 20,25),  sec.axis = sec_axis(~. +0, name = "Elevation (feet)", breaks = dfMeadPoolsPlot2$stor_maf, labels = dfMeadPoolsPlot2$label)) +
#    scale_y_continuous(breaks = c(0,5.98,9.6,12.2,dfMaxStor[2,2]),labels=c(0,5.98,9.6,12.2,dfMaxStor[2,2]),  sec.axis = sec_axis(~. +0, name = "Mead Level (feet)", breaks = c(0,5.98,9.6,12.2,dfMaxStor[2,2]), labels = c(895,1025,1075,1105,1218.8))) +
#scale_x_discrete(breaks=cMonths, labels= cMonthsLabels) +
#scale_x_continuous(breaks=seq(1960,2020,by=10)) +
#scale_fill_manual(breaks=c(1:6),values = palBlues[2:7]) + #,labels = variable) +
theme_bw() +
#coord_fixed() +
labs(x="", y="Mead Active Storage (MAF)", fill = "Pool") +
theme(text = element_text(size=20), legend.title=element_blank(),
legend.text=element_text(size=18), legend.position = "none",
axis.text.x = element_text(size=18))
ggplot() +
#Zone levels
geom_line(data=dfPlotData,aes(x=Month,y=stor_maf, group = as.factor(level), color = as.factor(level)), size=1.25) +
#Mead storage
geom_line(data=dfMeadHist,aes(x=BeginOfMon,y=Stor/1e6), size=2) +
#scale_color_manual(values = palBlues) +
#geom_area(data=dfPlotData,aes(x=month,y=stor_maf, fill = variable), position='stack') +
#scale_fill_manual(values = palBlues[7:-1:2]) +
#Flood pools as a function of upstream storage
#geom_line(data=dfFloodPoolsMelt,aes(x=month_num, y=value, group = variable), size=1) +
#Label the flood pool contours of empty upstream storage
#geom_label(data=dfFloodPoolsMelt %>% filter(month_num %in% c(3,11)), aes( x = month_num, y = value, label = variable, fontface="bold"), size=5, angle = 0) +
#geom_label(aes( x = 7, y = 23, label = "[MAF of empty upstream storage]", fontface="bold"), label.size = 0, size=5, angle = 0) +
scale_y_continuous(breaks = c(0,5,10,15,20,25),labels=c(0,5,10,15, 20,25),  sec.axis = sec_axis(~. +0, name = "Elevation (feet)", breaks = dfMeadPoolsPlot2$stor_maf, labels = dfMeadPoolsPlot2$label)) +
#    scale_y_continuous(breaks = c(0,5.98,9.6,12.2,dfMaxStor[2,2]),labels=c(0,5.98,9.6,12.2,dfMaxStor[2,2]),  sec.axis = sec_axis(~. +0, name = "Mead Level (feet)", breaks = c(0,5.98,9.6,12.2,dfMaxStor[2,2]), labels = c(895,1025,1075,1105,1218.8))) +
#scale_x_discrete(breaks=cMonths, labels= cMonthsLabels) +
#scale_x_continuous(breaks=seq(1960,2020,by=10)) +
#scale_fill_manual(breaks=c(1:6),values = palBlues[2:7]) + #,labels = variable) +
theme_bw() +
#coord_fixed() +
labs(x="", y="Mead Active Storage (MAF)", fill = "Pool") +
theme(text = element_text(size=20), legend.title=element_blank(),
legend.text=element_text(size=18), legend.position = "none",
axis.text.x = element_text(size=18))
ggplot() +
#Zone levels
geom_line(data=dfPlotData,aes(x=Month,y=stor_maf, group = as.factor(level), color = as.factor(level)), size=1.25) +
#Mead storage
geom_line(data=dfMeadHist,aes(x=BeginOfMon,y=Stor/1e6), size=2) +
scale_color_manual(values = palBlues)
ggplot() +
#Zone levels
geom_line(data=dfPlotData,aes(x=Month,y=stor_maf, group = as.factor(level), color = as.factor(level)), size=1.25) +
#Mead storage
geom_line(data=dfMeadHist,aes(x=BeginOfMon,y=Stor/1e6), size=2) +
scale_color_manual(values = palBlues) +
#geom_area(data=dfPlotData,aes(x=month,y=stor_maf, fill = variable), position='stack') +
#scale_fill_manual(values = palBlues[7:-1:2]) +
#Flood pools as a function of upstream storage
#geom_line(data=dfFloodPoolsMelt,aes(x=month_num, y=value, group = variable), size=1) +
#Label the flood pool contours of empty upstream storage
#geom_label(data=dfFloodPoolsMelt %>% filter(month_num %in% c(3,11)), aes( x = month_num, y = value, label = variable, fontface="bold"), size=5, angle = 0) +
#geom_label(aes( x = 7, y = 23, label = "[MAF of empty upstream storage]", fontface="bold"), label.size = 0, size=5, angle = 0) +
scale_y_continuous(breaks = c(0,5,10,15,20,25),labels=c(0,5,10,15, 20,25),  sec.axis = sec_axis(~. +0, name = "Elevation (feet)", breaks = dfMeadPoolsPlot2$stor_maf, labels = dfMeadPoolsPlot2$label)) +
#    scale_y_continuous(breaks = c(0,5.98,9.6,12.2,dfMaxStor[2,2]),labels=c(0,5.98,9.6,12.2,dfMaxStor[2,2]),  sec.axis = sec_axis(~. +0, name = "Mead Level (feet)", breaks = c(0,5.98,9.6,12.2,dfMaxStor[2,2]), labels = c(895,1025,1075,1105,1218.8))) +
#scale_x_discrete(breaks=cMonths, labels= cMonthsLabels) +
#scale_x_continuous(breaks=seq(1960,2020,by=10)) +
#scale_fill_manual(breaks=c(1:6),values = palBlues[2:7]) + #,labels = variable) +
theme_bw() +
#coord_fixed() +
labs(x="", y="Mead Active Storage (MAF)", fill = "Pool") +
theme(text = element_text(size=20), legend.title=element_blank(),
legend.text=element_text(size=18), legend.position = "none",
axis.text.x = element_text(size=18))
ggplot() +
#Zone levels
geom_line(data=dfPlotData,aes(x=Month,y=stor_maf, group = as.factor(level), color = as.factor(level)), size=1.25) +
#Mead storage
geom_line(data=dfMeadHist,aes(x=BeginOfMon,y=Stor/1e6), size=2) +
scale_color_manual(values = palBlues[seq(10,6,by=-1)]) +
#geom_area(data=dfPlotData,aes(x=month,y=stor_maf, fill = variable), position='stack') +
#scale_fill_manual(values = palBlues[7:-1:2]) +
#Flood pools as a function of upstream storage
#geom_line(data=dfFloodPoolsMelt,aes(x=month_num, y=value, group = variable), size=1) +
#Label the flood pool contours of empty upstream storage
#geom_label(data=dfFloodPoolsMelt %>% filter(month_num %in% c(3,11)), aes( x = month_num, y = value, label = variable, fontface="bold"), size=5, angle = 0) +
#geom_label(aes( x = 7, y = 23, label = "[MAF of empty upstream storage]", fontface="bold"), label.size = 0, size=5, angle = 0) +
scale_y_continuous(breaks = c(0,5,10,15,20,25),labels=c(0,5,10,15, 20,25),  sec.axis = sec_axis(~. +0, name = "Elevation (feet)", breaks = dfMeadPoolsPlot2$stor_maf, labels = dfMeadPoolsPlot2$label)) +
#    scale_y_continuous(breaks = c(0,5.98,9.6,12.2,dfMaxStor[2,2]),labels=c(0,5.98,9.6,12.2,dfMaxStor[2,2]),  sec.axis = sec_axis(~. +0, name = "Mead Level (feet)", breaks = c(0,5.98,9.6,12.2,dfMaxStor[2,2]), labels = c(895,1025,1075,1105,1218.8))) +
#scale_x_discrete(breaks=cMonths, labels= cMonthsLabels) +
#scale_x_continuous(breaks=seq(1960,2020,by=10)) +
#scale_fill_manual(breaks=c(1:6),values = palBlues[2:7]) + #,labels = variable) +
theme_bw() +
#coord_fixed() +
labs(x="", y="Mead Active Storage (MAF)", fill = "Pool") +
theme(text = element_text(size=20), legend.title=element_blank(),
legend.text=element_text(size=18), legend.position = "none",
axis.text.x = element_text(size=18))
ggplot() +
#Zone levels
geom_line(data=dfPlotData,aes(x=Month,y=stor_maf, group = as.factor(level), color = as.factor(level)), size=1.25) +
#Mead storage
geom_line(data=dfMeadHist,aes(x=BeginOfMon,y=Stor/1e6), size=2) +
scale_color_manual(values = palBlues[seq(10,5,by=-1)]) +
#geom_area(data=dfPlotData,aes(x=month,y=stor_maf, fill = variable), position='stack') +
#scale_fill_manual(values = palBlues[7:-1:2]) +
#Flood pools as a function of upstream storage
#geom_line(data=dfFloodPoolsMelt,aes(x=month_num, y=value, group = variable), size=1) +
#Label the flood pool contours of empty upstream storage
#geom_label(data=dfFloodPoolsMelt %>% filter(month_num %in% c(3,11)), aes( x = month_num, y = value, label = variable, fontface="bold"), size=5, angle = 0) +
#geom_label(aes( x = 7, y = 23, label = "[MAF of empty upstream storage]", fontface="bold"), label.size = 0, size=5, angle = 0) +
scale_y_continuous(breaks = c(0,5,10,15,20,25),labels=c(0,5,10,15, 20,25),  sec.axis = sec_axis(~. +0, name = "Elevation (feet)", breaks = dfMeadPoolsPlot2$stor_maf, labels = dfMeadPoolsPlot2$label)) +
#    scale_y_continuous(breaks = c(0,5.98,9.6,12.2,dfMaxStor[2,2]),labels=c(0,5.98,9.6,12.2,dfMaxStor[2,2]),  sec.axis = sec_axis(~. +0, name = "Mead Level (feet)", breaks = c(0,5.98,9.6,12.2,dfMaxStor[2,2]), labels = c(895,1025,1075,1105,1218.8))) +
#scale_x_discrete(breaks=cMonths, labels= cMonthsLabels) +
#scale_x_continuous(breaks=seq(1960,2020,by=10)) +
#scale_fill_manual(breaks=c(1:6),values = palBlues[2:7]) + #,labels = variable) +
theme_bw() +
#coord_fixed() +
labs(x="", y="Mead Active Storage (MAF)", fill = "Pool") +
theme(text = element_text(size=20), legend.title=element_blank(),
legend.text=element_text(size=18), legend.position = "none",
axis.text.x = element_text(size=18))
ggplot() +
#Zone levels
geom_line(data=dfPlotData,aes(x=Month,y=stor_maf, group = as.factor(level), color = as.factor(level)), size=1.25) +
#Mead storage
geom_line(data=dfMeadHist,aes(x=BeginOfMon,y=Stor/1e6), size=2) +
scale_color_manual(values = palBlues[seq(5,10)]) +
#geom_area(data=dfPlotData,aes(x=month,y=stor_maf, fill = variable), position='stack') +
#scale_fill_manual(values = palBlues[7:-1:2]) +
#Flood pools as a function of upstream storage
#geom_line(data=dfFloodPoolsMelt,aes(x=month_num, y=value, group = variable), size=1) +
#Label the flood pool contours of empty upstream storage
#geom_label(data=dfFloodPoolsMelt %>% filter(month_num %in% c(3,11)), aes( x = month_num, y = value, label = variable, fontface="bold"), size=5, angle = 0) +
#geom_label(aes( x = 7, y = 23, label = "[MAF of empty upstream storage]", fontface="bold"), label.size = 0, size=5, angle = 0) +
scale_y_continuous(breaks = c(0,5,10,15,20,25),labels=c(0,5,10,15, 20,25),  sec.axis = sec_axis(~. +0, name = "Elevation (feet)", breaks = dfMeadPoolsPlot2$stor_maf, labels = dfMeadPoolsPlot2$label)) +
#    scale_y_continuous(breaks = c(0,5.98,9.6,12.2,dfMaxStor[2,2]),labels=c(0,5.98,9.6,12.2,dfMaxStor[2,2]),  sec.axis = sec_axis(~. +0, name = "Mead Level (feet)", breaks = c(0,5.98,9.6,12.2,dfMaxStor[2,2]), labels = c(895,1025,1075,1105,1218.8))) +
#scale_x_discrete(breaks=cMonths, labels= cMonthsLabels) +
#scale_x_continuous(breaks=seq(1960,2020,by=10)) +
#scale_fill_manual(breaks=c(1:6),values = palBlues[2:7]) + #,labels = variable) +
theme_bw() +
#coord_fixed() +
labs(x="", y="Mead Active Storage (MAF)", fill = "Pool") +
theme(text = element_text(size=20), legend.title=element_blank(),
legend.text=element_text(size=18), legend.position = "none",
axis.text.x = element_text(size=18))
ggsave("MeadTimeSeries.png", width=9, height = 6.5, units="in")
